(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("object-hash"),require("riot"),require("lodash"),require("cookie"),require("date-fns")):"function"==typeof define&&define.amd?define(["object-hash","riot","lodash","cookie","date-fns"],t):(e=e||self,e.uR=t(e["object-hash"],e.riot,e.lodash,e.cookie,e["date-fns"]))})(this,function(e,t,a,r,s){'use strict';function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var a,r=0;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}function l(e,t,a){return t&&i(e.prototype,t),a&&i(e,a),e}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function c(e){for(var t,a=1;a<arguments.length;a++)t=null==arguments[a]?{}:arguments[a],a%2?d(t,!0).forEach(function(a){u(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(t).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))});return e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return t&&("object"==typeof t||"function"==typeof t)?t:_(e)}function y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=p(e),null!==e););return e}function b(e,t,a){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,a){var r=y(e,t);if(r){var s=Object.getOwnPropertyDescriptor(r,t);return s.get?s.get.call(a):s.value}},b(e,t,a||e)}function f(e,t){return E(e)||x(e,t)||T()}function v(e){return k(e)||S(e)||w()}function k(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}}function E(e){if(Array.isArray(e))return e}function S(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function x(e,t){var a=[],r=!0,s=!1,o=void 0;try{for(var n,i=e[Symbol.iterator]();!(r=(n=i.next()).done)&&(a.push(n.value),!(t&&a.length===t));r=!0);}catch(e){s=!0,o=e}finally{try{r||null==i["return"]||i["return"]()}finally{if(s)throw o}}return a}function w(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}/* A task queue that can be started and stopped.
     Usage:
     ready = Ready();
     const f = () => console.log(1);
     ready(f);
     ready(f,f,f);
     ready.start(); // logs 1 four times
     ready(f) // logs 1
     ready.stop();
     ready(f); // no logs (until next start)
  */e=e&&e.hasOwnProperty("default")?e["default"]:e,t=t&&t.hasOwnProperty("default")?t["default"]:t;var A="default"in a?a["default"]:a;r=r&&r.hasOwnProperty("default")?r["default"]:r;var O=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){return!1},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],a=1,r=function a(){for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];for(t=t.concat(s);e()&&t.length;)t.shift()();for(;e()&&a._then.length;)a._then.shift()()};return r._then=[],r.then=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];r._then=r._then.concat(t),r()},r.start=function(t){return a&&a--,a||(e=function(){return!0},r()),t},r.stop=function(){a+=1,e=function(){return!1}},r},P={_routes:{},do404:function(){throw"NotImplemented"},// #! TODO
MODAL_PREFIX:/^#!/,ready:O(),add:function(e){return Object.assign(P._routes,e)}};t.observable(P);var I=A.merge({},{// bootstrap is default
default:{outer:"card",content:"card-body",footer:"card-footer",header:"card-header",header_title:"h4"},modal:{mask:"modal-backgrop fade show",root:"modal",outer:"modal-dialog modal-content",header:"modal-header",content:"modal-body",footer:"modal-footer",header_title:"modal-title"},none:{header_title:"h4"},error:"alert alert-danger",table:"table table-striped table-hover",form:{field:"input-field",select:"browser-default"},btn:{default:"btn",primary:"btn btn-primary",success:"btn btn-success",cancel:"btn btn-error",warning:"btn bg-warning",link:"btn btn-link",group:"btn-group",group_block:"btn-group"// DNE for bootstrap
},bg:{},// #! TODO bootstrap
mixin_attrs:["btn","bg"]},{modal:{mask:"modal-overlay",root:"modal active",outer:"modal-container",header_title:"modal-title h4"},form:{field:"form-group mb-2",input:"form-input",label:"form-label"},btn:{group_block:"btn-group btn-group-block"},error:"bg-gray text-error p-2 mb-2",success:"label label-success mb-2",hide:"d-hide",text:{primary:"text-primary",secondary:"text-secondary",dark:"text-dark",gray:"text-gray",light:"text-light",success:"text-success",warning:"text-warning",error:"text-error",red:"text-error"},bg:{primary:"bg-primary p-1",secondary:"bg-secondary p-1",dark:"bg-dark p-1",gray:"bg-gray p-1",light:"bg-light p-1",success:"bg-success p-1",warning:"bg-warning p-1",error:"bg-error p-1",red:"bg-error p-1"// #! TODO
// this needs to eventually look at link tags and decide on mixins
// maybe should be wrapped in uR.ready, but then importing in ThemeMixin is complicated
}}),M={},C=function(e){return M[e]||"fa fa-"+e};C.overrides=M;var j={init:function(){this.css=A.cloneDeep(I),Object.assign(this,A.pick(this.css,this.css.mixin_attrs),{icon:C})}},U={init:function(e){var t=this;if(this.mixin(j),this.theme=e.ur_modal?this.css.modal:this.css[e.theme||"default"],e.ur_modal){e.cancel&&this.one("unmount",e.cancel);var a=document.createElement("div");a.className=this.theme.mask,a.addEventListener("click",function(){return t.unmount()}),this.root.appendChild(a)}this.theme.root&&this.theme.root.split(" ").forEach(function(e){return t.root.classList.add(e)})}};Object.assign(I,{ThemeMixin:U,Mixin:j,icon:C});var D={ready:O(),urls:{start:"#!/auth/",register:"#!/auth/register/",login:"#!/auth/login/",reset:"/user.json",register_ajax:"/api/auth/register/",login_ajax:"/api/auth/login/",logout_ajax:"/api/auth/logout/",logout:"#!/auth/logout/"},GREETING:"Please Login to Continue"},R=a.debounce(function(e){window.location.pathname===e||// #! TODO the empty string here is the page title. Need some sort of lookup table
history.replaceState({path:e},document.title,e)},100),N=function(e){for(var t in P._routes){var a=new RegExp(t),r=e.match(a);if(r)return r.key=t,r}},H=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=new URL(e,e.match("://")?void 0:window.location.origin),s=new URL(window.location.href),o=(r.pathname||e).replace(window.location.origin,""),n=N(o),i=r&&N(r.hash);P.trigger("route"),i&&(t=c({matches:i,ur_modal:r.hash.match(P.MODAL_PREFIX),cancel:function(){window.location.hash="",this.unmount&&this.unmount()}},t),P._routes[i.key](r.hash,t)),n&&(a.extend(t,{matches:n}),document.body.dataset.ur_path=o,P._routes[n.key](o,t),P._stale&&(window.location.hash="")),i||n||!P.default_route||P.default_route(o),R(e),P._stale=!0},z=function(t){if(!(1!==t.which||// not left click
t.metaKey||t.ctrlKey||t.shiftKey||// or meta keys
t.defaultPrevented// or default prevented
)){for(var e=t.target,a=window.history.location||window.location;e&&"A"!==e.nodeName;)e=e.parentNode;!e||"A"!==e.nodeName||// not A tag
e.hasAttribute("download")||// has download attr
!e.hasAttribute("href")||// has no href attr
e.target&&"_self"!==e.target||// another window or frame
-1===e.href.indexOf(a.href.match(/^.+?\/\/+[^/]+/)[0])// cross origin
||(/*if (el.href !== loc.href && (
      el.href.split('#')[0] === loc.href.split('#')[0] // internal jump
      || el.href.startsWith("#") // hash only
      || base[0] !== '#' && getPathFromRoot(el.href).indexOf(base) !== 0 // outside of base
      || base[0] === '#' && el.href.split(base)[0] != loc.href.split(base)[0] // outside of #base
      || !go(getPathFromBase(el.href), el.title || document.title) // route not found
      )) return*/t.preventDefault(),H(e.href))}},F=function(e){for(var t=e.childNodes,a=e.childNodes.length;a--;)e.removeChild(t[a])},L=function(e,a,r){var s=document.createElement(e);if(a.parent&&("string"==typeof a.parent&&(a.parent=document.querySelector(a.parent)),a.clear&&(F(a.parent),delete a.clear),a.parent.appendChild(s),delete a.parent),Object.assign(s,a),r)try{t.mount(s,r)}catch(t){throw console.error("unable to mount",s,r),t}return s},q={mount_alerts_to:"#ur-alerts",mount_to:"#ur-content"};"undefined"!=typeof document&&[q.mount_alerts_to,q.mount_to].forEach(function(e){document.querySelector(e)||L("div",{id:e.replace("#",""),parent:document.body})});var K={alert:function(e,t,a){return a&&(a.ur_modal=!0),t.parent=q.mount_alerts_to,L(e,t,a)},config:q,create:L,emptyElement:F,text2obj:function(e){// takes in a string or an object, returns an object like { text: String }
return"string"==typeof e?{text:e}:e}};Object.assign(P,{route:H,routeElement:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(a){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};r=c({},r,{},"function"==typeof t?t(a,r):t);var s=e.toUpperCase(),o=P._current_tag,n={parent:K.config[r.ur_modal?"mount_alerts_to":"mount_to"],clear:!0};o&&o.root.tagName===s?o.trigger("route",r):K.create(e,n,r)}},resolve:N,clearHash:function(){window.location.hash=""}}),P.ready(function(){document.addEventListener("click",z),P._stale||P.route(window.location.href),window.addEventListener("hashchange",function(){var e=window.location.pathname;window.location.hash&&(e+="#"+window.location.hash)})});var B=function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")},V=function(e){"string"==typeof e&&(e={url:e});var t=e.url,a={method:e.method||"GET",headers:{"X-CSRFToken":r.parse(document.cookie).csrftoken}};return"GET"!==a.method||A.isEmpty(e.data)?e.data&&(a.body=JSON.stringify(e.data)):(t.endswith("?")&&(t+="?"),t+=B(e.data)),fetch(t,a).then(function(e){if(400<=e.status)throw"NotImplemented: HTTP"+e.status;return e.json()})};t.tag2("ur-auth-start","<div class=\"{theme.outer}\"> <div class=\"{theme.header}\"> <div class=\"{theme.header_title}\">{auth.GREETING}</div> </div> <div class=\"{theme.content}\"> <p> <a href=\"{auth.urls.register}\" class=\"{css.btn.primary}\">Create New Account</a> </p> <p> <a href=\"{auth.urls.login}\" class=\"{css.btn.default}\">Login</a> </p> </div> </div>","","",function(){this.auth=D,this.mixin("ThemeMixin")}),t.tag2("ur-auth-login","<div class=\"{theme.outer}\"> <div class=\"{theme.content}\"> <ur-form schema=\"{schema}\" submit=\"{submit}\" url=\"{url}\" success=\"{success}\"></ur-form> </div> </div>","","",function(){this.on("mount",()=>{D.user&&D.user.id&&(uR.router.route(uR.router.default_url),this.unmount())}),this.mixin("ThemeMixin"),this.schema={username:{},password:{type:"password"}},this.submit=e=>(D.AUTH_SUCCESS=()=>window.location.reload(),V({url:D.urls.login_ajax,data:e.getData(),method:"POST"}).then(()=>D.reset()))});var G=function(e){!e&&!D.user||D.user&&e&&D.user.id===e.id||(// already logged in
// #!TODO storage.set('auth.user',user || null); // JSON.stringify hates undefined
D.user=e,t.update(D.tag_names))};D.ready(function(){var e,t=P.routeElement("ur-auth-register");D.FAST_REGISTER&&(t=function(){V(D.urls.register_ajax).then(D.reset)}),P.add((e={},u(e,D.urls.start+"$",P.routeElement("ur-auth-start")),u(e,D.urls.login,P.routeElement("ur-auth-login")),u(e,D.urls.register,t),u(e,D.urls.logout,function(){V({url:D.urls.logout_ajax,method:"POST"}).then(function(){uR.router.route("#"),window.location.reload()})}),e))}),Object.assign(D,{loginRequired:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};// first argument can be a string to imply we should route directly to a tag
// #! TODO it would probably be better to do this as a flag on routeElement instead
// or make a separate shortcut
if("string"==typeof e){var a=e;e=function(e,t){return L(a,t)}}var r=function(){var a=arguments;D.ready(function(){var r=function(t){t&&D.setUser(t.user),-1!==window.location.href.indexOf("/auth/")&&P.clearHash(),e.apply(void 0,v(a))};!D.user||t.force?(D.AUTH_SUCCESS=r,t.next=window.location.href,D.auto?P.route(D.urls.register,t):P.route(D.urls.start,t)):r()})};return r.login_required=!0,r},setUser:G,reset:function(){return D.enabled?(D.setUser(),V({url:D.urls.reset}).then(function(e){D.setUser(e.user),D.ready.start(),D.user&&D.AUTH_SUCCESS&&(D.AUTH_SUCCESS(),D.AUTH_SUCCESS=void 0)})):(D.setUser({username:"TEST USER",email:"anon@example.com",id:-1,is_superuser:!0}),D.ready.start(),D.user&&D.AUTH_SUCCESS&&(D.AUTH_SUCCESS(),D.AUTH_SUCCESS=void 0),!0)},enabled:!0,FAST_REGISTER:!0});var X=O(),Y=function(e){return"string"!=typeof e&&(e=e.toString()),e.replace(/[-_]/g," ").replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()})},$=function(e){return e.replace(/([A-Z])/g," $1")// uppercase the first character
.replace(/^./,a.toUpper)},Q=function(e){if(e.slug){var t=e.slug.split("."),a=f(t,2);e.app_label=a[0],e.model_name=a[1]}else if(e.app_label&&e.model_name)e.slug="".concat(e.app_label,".").concat(e.model_name);else throw"Model \"".concat(e.name,"\" needs app_label and model_name or a slug")},J=function(e){return W.db[e]||(W.db[e]={verbose_name:Y(e||"main"),name:e,_models:[]},W.db.apps.push(W.db[e])),W.db[e]},W=function e(t){Q(t);var a=t.app_label,r=t.model_name,s=t.slug,o=J(a);e.db[s]=o[r]=t,o._models.push(t),t.verbose_name=t.verbose_name||$(r)},Z=function(e,t){if(!e)throw t},ee=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=c({initial:e,serialize:function(e){return e=a.coerce(e),a.validators.forEach(function(t){return t(e)}),e},validators:[],coerce:function(e){return e},toString:function(){return"".concat(a.model.name,".").concat(a.name)},model:{},// set by __makeMeta on an Model
deserialize:function(e){return e},type:t.type,required:t.required||void 0===t.required},t);return a.required&&// defaults to true!
a.validators.push(function(e){return Z(!A.isNil(e),"ValueError: ".concat(a," is required"))}),a},te=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t.type="int";var a=ee(e,t);return a.validators.push(function(e){A.isNil(e)||Z(!isNaN(e),"ValueError: ".concat(a," requires a number"))}),a.coerce=function(e){return"string"==typeof e?+e:e},a},ae=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t.type="string";var a=ee(e,t);return a.validators.push(function(e){A.isNil(e)||""===e||Z("string"==typeof e,"ValueError: ".concat(a," requires a string not ").concat(e))}),a},re=te,se=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t.type="boolean",t.coerce=function(e){return e&&"false"!==e};var a=ee(e,t);return a},oe=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=function(e){return e};return"function"==typeof e&&(a=function(t){return(t||[]).map(function(t){return new e(t)})}),ee([],c({type:"list",serialize:function(e){return(e||[]).map(function(e){return A.isFunction(e.serialize)?e.serialize():e})},deserialize:a},t))},ne={number:re,string:ae,boolean:se,array:oe},ie=/*#__PURE__*/Object.freeze({TYPES:ne,Number:re,List:oe,Boolean:se,Field:ee,Int:te,ForeignKey:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=ee(void 0,t);return X(function(){"string"==typeof e&&(e=a.fk_model=A.get(W.db,e));var t=function(e,t){return e[a.name+"_id"]=t.id,e[a.name]=t,t};a.deserialize=function(r,s,o){if(r instanceof e)return t(o,r);var n;return!r&&s[a.name+"_id"]?r=s[a.name+"_id"]:r&&r.id&&(n=r,r=r.id),r&&!n&&(n=e.objects.get(r)),n&&t(o,n)}}),Object.assign(a,{type:"foreignkey",fk_model:e,deserialize:function(e,t,r){return X(function(){a.deserialize(e,t,r)}),e},serialize:function(e){return"string"==typeof e?parseInt(e):"number"==typeof e?e:e&&e.id}}),a},String:ae,DateTime:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.auto_now_add||e.auto_now?function(){return new Date().valueOf()}:void 0,a=ee(t,e);return Object.assign(a,{type:"datetime",serialize:function(e){return"string"==typeof e?new Date(e).valueOf():e&&e.valueOf?e.valueOf():e}})},Time:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=ee(e,t);return a.type="time",a}}),le=A.negate(A.isNil),ue=/*#__PURE__*/function(){//static fields = { id: 0 } // defines the data structure to be serialized
//manager = // Storage class to be used for instances
function e(t){n(this,e),this.opts=t,this.makeOpts(t),this.makeMeta(),this.deserialize(t)}return l(e,[{key:"makeOpts",value:function(e){this.constructor.__makeOpts();for(var t=0,a=Object.entries(this.constructor.BASE_OPTS);t<a.length;t++){var r=f(a[t],2),s=r[0],o=r[1];this[s]=void 0===e[s]?o:e[s]}}},{key:"getFields",value:function(){return this.META.fields}},{key:"makeMeta",value:function(){this.constructor.__makeMeta(),this.META=this.constructor.META}},{key:"deserialize",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.META.fields.forEach(function(a,r){var s=t[r];t.hasOwnProperty(r)||(s=a.initial),"function"==typeof s&&(s=s()),e[r]=a.deserialize?a.deserialize(s,t,e):"function"==typeof a?a.prototype?new a(e,s):a(e,s):s})}},{key:"serialize",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:v(this.META.fields.keys()),a=A.pick(this,t);return Object.keys(a).forEach(function(t){var r=e.META.fields.get(t);a[t]=r.serialize(a[t])}),A.pickBy(a,le)}},{key:"getFieldnames",value:function(){return this.constructor.editable_fieldnames||[]}},{key:"__str__",value:function(){return"[".concat(this.constructor.model_name," #").concat(this.id,"]")}}],[{key:"__makeOpts",value:function(){var t=this;if(!this.hasOwnProperty("BASE_OPTS")){this.BASE_OPTS=c({},this.opts);for(var a=this;a!==e;)a=Object.getPrototypeOf(a),a.opts&&Object.entries(a.opts).forEach(function(e){var a=f(e,2),r=a[0],s=a[1];t.BASE_OPTS.hasOwnProperty(r)||(t.BASE_OPTS[r]=s)})}// only execute once!
}},{key:"__makeMeta",value:function(){var t=this;// this is for model level setup (eg primitives to fields or adding manager)
if(!this.hasOwnProperty("META")){this.META={};var a=this,r=this.manager;W(this);for(var s=[a.fields];a!==e;)a=Object.getPrototypeOf(a),a.hasOwnProperty("fields")&&s.push(a.fields),r=r||a.manager;var n=this.META.fields=new Map(Object.entries(A.defaults.apply(A,[{},r&&r.fields].concat(v(A.reverse(s))))));n.forEach(function(e,a){var r=o(e);if("object"!==r);else Array.isArray(e)&&(r="array");var s=ne[r];// primitives are lazily coerced
s&&n.set(a,e=s(e)),e.name=a,e.model=t}),r&&!this.objects&&(this.objects=new r(this)),this.prototype.toString=function(){return this.__str__()}}// only execute once!
}}]),e}();/* uR.schema.unslugify usage:
     "this_is_a_slug" => "This Is A Slug"
     "ABC.xyz%$_()  asRt" => "Abc Xyz Arst"
  */ue.opts={};// non-data initialization options
var de=/*#__PURE__*/function(){function e(t){var a=this;n(this,e),u(this,"create",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e=a.normalize(e);var t=new a.model(e);return a.set(t)}),u(this,"save",function(e){return console.warn("Manager.save should be renamed to set"),a.set(e)}),u(this,"set",function(e){return a._set(e),Promise.resolve(e)}),u(this,"_set",function(e){if(e instanceof a.model||(e=new a.model(e)),!e.id)if(uR.FAKE_IDS)e.id=++a._next_id;else throw"Object cannot be set without id";return a.items.set(e.id,e),e}),this._next_id=0,this.model=t,t.manager=t.manager||this.constructor,t.objects=this,this.model.__makeMeta(),this.refresh()}return l(e,[{key:"normalize",value:function(e){return"function"==typeof e.serialize&&(e=e.serialize()),Object.entries(e).forEach(function(t){var a=f(t,2),r=a[0],s=a[1];// this is just for foreign key
// maybe the Model constructor could serialize it first?
s instanceof ue&&(e[r]=s.id)}),e}},{key:"all",value:function(){return v(this.items.values())}},{key:"filter",value:function(e){var t=this.all();return"function"==typeof e?t.filter(e):(Object.entries(e).forEach(function(e){var a=f(e,2),s=a[0],o=a[1];t=t.filter(function(e){return e[s]===o})}),t)}},{key:"refresh",value:function(){this.items=new Map}},{key:"get",value:function(e){return this.items.get(parseInt(e))}}]),e}(),ce=/*#__PURE__*/function(e){function t(){var e,a;n(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=g(this,(e=p(t)).call.apply(e,[this].concat(s))),u(_(a),"create",function(e){return e=a.normalize(e),X.stop(),V({url:a._get_base_url(),method:"POST",data:e}).then(function(e){var t=a._set(e);//#! TODO
return X.start(),t})}),a}return m(t,e),l(t,[{key:"refresh",value:function(){var e=this;// #! TODO should be ready.block or ready.ajax
return X.stop(),V(this._get_base_url()).then(function(t){e.pagination=t.pagination,e.items=new Map,t.results.forEach(e._set)}).then(X.start);//#! TODO
}},{key:"_get_base_url",value:function(){var e=this.model,t=e.app_label,a=e.model_name;return"/api/".concat(t,"/").concat(a,"/")}}]),t}(de),me=/*#__PURE__*/function(){function e(t){if(n(this,e),this.PREFIX=t||"",this.META="META/",this.defaults={},this._schema={},this.__CACHE={},!this.test_supported()){console.warn("Storage not supported, falling back to dummy storage");var a={};this.set=function(e,t){return a[e]=t},this.get=function(e){return a[e]},this.has=function(e){return a.hasOwnProperty(e)},this.remove=function(e){return delete a[e]}}this.times=this.get(this.META+"times")||{},this.keys=this.get(this.META+"keys")||[]}return l(e,[{key:"_",value:function(e){return this.PREFIX+e}},{key:"_getItem",value:function(e){return void 0===this.__CACHE[e]&&(this.__CACHE[e]=localStorage.getItem(this._(e))),this.__CACHE[e]}},{key:"_setItem",value:function(e,t){localStorage.setItem(this._(e),this.__CACHE[e]=t)}},{key:"_removeItem",value:function(e){return localStorage.removeItem(this._(e))}},{key:"_hasOwnProperty",value:function(e){return localStorage.hasOwnProperty(this._(e))}},{key:"get",value:function(t){// pull a json from local storage or get an object from the defaults dict
var a;if(this._hasOwnProperty(t))try{a=JSON.parse(this._getItem(t))}catch(r){console.warn("Item \"".concat(t,"\" in Storage(").concat(this.PREFIX,") was not JSON"),a),a||this.remove(t)}else this.defaults.hasOwnProperty(t)&&(a=this.defaults[t]);return a}},{key:"update",value:function(e){for(var t in e)e.hasOwnProperty(t)&&this.set(t,e[t])}},{key:"set",value:function(e,t){// store stringified json in localstorage
return t||0===t||""===t?(this._setItem(e,JSON.stringify(t)),this.times[e]=new Date().valueOf(),-1===this.keys.indexOf(e)?this.keys.push(e):void 0,this._save(),this.get(e)):this.remove(e)}},{key:"has",value:function(e){return-1!==this.keys.indexOf(e)}},{key:"remove",value:function(e){this._removeItem(e),this.keys=this.keys.filter(function(t){return t!==e}),delete this.times[e],this._save()}},{key:"clear",value:function(){for(var e in this.times)this.remove(e);this._save()}},{key:"_save",value:function(){this._setItem(this.META+"times",JSON.stringify(this.times)),this._setItem(this.META+"keys",JSON.stringify(this.keys))}},{key:"test_supported",value:function(){// incognito safari and older browsers don't support local storage. Use an object in ram as a dummy
try{return localStorage.setItem("test","1"),localStorage.removeItem("test"),!0}catch(t){console.warn("No local storage found. Falling back.")}}}]),e}(),pe=/*#__PURE__*/function(e){function t(e){var a;return n(this,t),a=g(this,p(t).call(this,e)),u(_(a),"_set",function(e){e.id||(e.id=a.next_id++),a.items.set(e.id,e),a.storage.set(e.id,e)}),a}return m(t,e),l(t,[{key:"refresh",value:function(){var e=this;return b(p(t.prototype),"refresh",this).call(this),this.next_id=1,this.storage=this.storage||new me(this.model.slug),this.storage.keys.forEach(function(t){var a=Math.max,r=new e.model(e.storage.get(t));e.next_id=a(e.next_id,r.id+1),e.set(r)}),Promise.resolve()}}]),t}(de);u(pe,"fields",{id:te(void 0,{required:!1})});var he=c({ready:X,register:W,APIManager:ce,BaseManager:de,StorageManager:pe,Model:ue,fields:ie,apps:[],REQUIRED:{}},ie,{getModel:function(e){return"string"==typeof e&&(e=he[e]),e}});W.db=he,t.tag2("ur-admin-app","<div class=\"{theme.outer}\"> <ur-breadcrumbs></ur-breadcrumbs> <div class=\"{theme.header}\"> <div class=\"{theme.header_title}\">{app.verbose_name} Admin</div> </div> <div class=\"{theme.content}\"> <ur-table></ur-table> </div> </div>","","",function(){this.mixin("ThemeMixin"),this.on("before-mount",function(){const e=this.opts.matches[1];this.app=he[e],this.thead=["Model","Count"],this.tbody=this.app._models.map(function(t){return[`<a href="#!/admin/${e}/${t.model_name}/">${t.verbose_name}</a>`,t.objects.all().length]}),this.update()})});class _e{constructor(e,t,a){this.items=[],this.path="#!/",this.addPath("Home","admin"),e&&this.addPath(e.name),t&&this.addPath(t.model_name),a&&this.addPath(a,a.id)}addPath(e,t){this.path+=(t||e)+"/",this.items.push({text:e,href:this.path})}}t.tag2("ur-breadcrumbs","<div style=\"display:flex\"> <div class=\"{css.word}\">{hostname}</div> <div each=\"{item,index in items}\" class=\"{css.crumb}\"> <a href=\"{item.href}\" class=\"{css.word}\"> {item.text} </a> </div> </div>","","class=\"{css.bread}\"",function(){this.css={bread:"breadcrumb",crumb:"breadcrumb-item",word:`${uR.css.bg.gray}`},this.hostname=window.location.hostname.split(".")[0];const{app:e,obj:t,model:a}=this.parent,r=new _e(e,a,t);this.items=r.items,this.items[this.items.length-1].last=!0,this.on("mount",()=>this.update())}),t.tag2("ur-admin-edit","<div class=\"{theme.outer}\"> <ur-breadcrumbs></ur-breadcrumbs> <div class=\"{theme.content}\"> <ur-form model=\"{model}\" object=\"{object}\" theme=\"none\" title=\"{title}\" success=\"{success}\"></ur-form> </div> </div>","","",function(){this.mixin("ThemeMixin"),this.success=function(e){if("new"===this.obj){const{app_label:t,model_name:a}=this.model;P.route(`#!/admin/${t}/${a}/${e.id}/`)}}.bind(this),this.on("before-mount",function(){const[e,t,a,r]=this.opts.matches;this.app=he[t],this.model=this.app[a],this.obj=this.object=this.model.objects.get(r),this.title=`Editing: ${this.object}`,this.object||(this.title="Add new "+this.model.model_name,this.obj="new")})}),t.tag2("ur-admin-home","<div class=\"{theme.outer}\"> <ur-breadcrumbs></ur-breadcrumbs> <div class=\"{theme.header}\"> <div class=\"{theme.header_title}\">Admin Home</div> </div> <div class=\"{theme.content}\"> <div class=\"mb-2\"> <ur-table></ur-table> </div> <div if=\"{links}\" class=\"mb-2\"> <h4>Debug Links</h4> <ur-table thead=\"{links.head}\" tbody=\"{links.body}\"></ur-table> </div> </div> </div>","","",function(){this.mixin(uR.css.ThemeMixin),this.on("mount",function(){this.thead=["Model","Count"],this.tbody=[],he.apps.map(e=>{const t=`#!/admin/${e.name}/`;e._models.filter(e=>e.objects).map(e=>this.tbody.push([`<a href="${t}${e.model_name}/">${e.slug}</a>`,e.objects.all().length]))}),console.warn("need to import DEBUG_URLS somehow");let e;if(e.length);this.update()})}),t.tag2("ur-admin-list","<div class=\"{theme.outer}\"> <ur-breadcrumbs></ur-breadcrumbs> <div class=\"{theme.header}\"> <div class=\"{theme.header_title}\"> {model.verbose_name} Admin <a class=\"{css.btn.primary} {css.right}\" href=\"#!/admin/{app.name}/{model.model_name}/new/\">New {model.verbose_name}</a> </div> </div> <div class=\"{theme.content}\"> <ur-table></ur-table> </div> </div>","","",function(){this.mixin("ThemeMixin"),this.on("before-mount",function(){const[e,t,a]=this.opts.matches;this.app=he[t],this.model=he[t][a],this.thead=["Object name"],this.tbody=this.model.objects.all().map(function(e){return[`<a href="#!/admin/${t}/${a}/${e.id}/">${e}</a>`]}),this.update()})}),t.tag2("ur-table","<table class=\"{css.table}\"> <thead></thead> <tbody></tbody> <tfoot></tfoot> </table>","","",function(){this.Mixin("CSSMixin"),this.on("mount",function(){var e=this;["thead","tbody","tfoot"].map(function(t){var a=e.root.querySelector(t),r=e.opts[t]||e.parent[t];r&&(!Array.isArray(r[0])&&(r=[r]),r&&r.map(function(e){var t=document.createElement("tr");e.map(function(e){("string"==typeof e||"number"==typeof e)&&(e={innerHTML:e+""}),e.parent=t,K.create("td",e)}),a.appendChild(t)}))})})});var ge=["mouseover","mouseout","mousemove","mouseclick","mouseup","mousedown","mousewheel","keydown","keyup"],ye=/*#__PURE__*/function(e){function t(e){var a;return n(this,t),a=g(this,p(t).call(this,e)),u(_(a),"unmount",function(){var e=_(a),t=e.parent;a.bound_actions.forEach(function(e){var a=f(e,2),r=a[0],s=a[1];t.removeEventListener(r,s)})}),a.bound_actions=[],a.bindKeys(),a}return m(t,e),l(t,[{key:"bindKeys",value:function(){var t=this,a=this.parent;a.tabIndex=a.tabIndex||"0",a.focus(),ge.filter(function(e){return t.target[e]}).forEach(function(r){var s=function(a){return t.target[r](a)};t.bound_actions.push([r,s]),a.addEventListener(r,s)})}}]),t}(he.Model);u(ye,"slug","unrest.Controller"),u(ye,"opts",{parent:he.REQUIRED,// html element to bind to
target:he.REQUIRED,// object being controlled
is_keyboard:!0});var be={fields:{},type:{number:{type:"number",validators:[function(e){if(e%2)throw"".concat(e," is not even")}]}},name:{}},fe=function(e){var t=f(e,2),a=t[0],r=t[1];return"object"!==o(r)&&(r={value:r}),c({type:"text"},be.type[o(r.value)],{},be.name[a],{},r,{name:a})},ve=function(e){return"function"==typeof e&&(e=e()),e instanceof Map&&(e=v(e.keys())),e.map(function(e){var t=o(e);return"undefined"===t?["","None"]:"string"===t||"number"===t?[e,e]:e})},ke=function(e){return"function"==typeof e&&(console.warn("opts is funciton, look at me"),e=e()),ve(e.choices).map(function(t,a){return{value:t[0],label:t[1],id:e.name+"__"+a}})},Ee={config:be,prep:fe,unslugify:Y,parseChoices:ve,prepChoices:ke},Se={tag2class:{},type2class:{},name2class:{}},xe=/*#__PURE__*/function(){function e(t){n(this,e),u(this,"ATTRS",["name","id","placeholder","required","minlength","value"]),u(this,"default_tag","ur-input"),A.defaults(this,t,{tagName:this.default_tag,input_tagname:"input",input_type:t.type,validators:[],coerce:function(e){return e},value:t.initial,//#! TODO: this is because spectre isn't playing nice
// remove this and then look at an empty, requierd inupt.
placeholder:" "}),"function"==typeof this.value&&(this.value=this.value()),this.css={label:I.form.label,field:"".concat(I.form.field," ur-").concat(t.type," field__").concat(this.name),input:I.form.input},this._updateCss()}return l(e,[{key:"_updateCss",value:function(){var e;this.css.error=(e={},u(e,I.error,!0),u(e,I.hide,this.valid||!this.show_error),e)}},{key:"_createInput",value:function(e){e=c({},e,{type:this.input_type,parent:this.tag.root,className:this.css.input}),this._input=L(this.input_tagname,A.omitBy(e,A.isNil))}},{key:"createInput",value:function(){this._createInput(A.pick(this,this.ATTRS))}},{key:"bindTag",value:function(e){this.tag=e,e.input=this,this.createInput(),this.bindEvents(this._input),this._checkValidity()}},{key:"_checkValidity",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.value;this.valid=!1;try{this.validators.forEach(function(t){return t(e)}),this.valid=!0,this.error=void 0,this.show_error=!0}catch(e){this.error=e}return this.valid}},{key:"_get_value",value:function(){return this.coerce(this._input.value)}},{key:"bindEvents",value:function(e){var t=this,a=this.tag.parent,r=A.debounce(a.submit,2e3);["change","focus","keyup","keydown"].forEach(function(s){e.addEventListener(s,function(){var e=t._get_value();t.value!==e&&(t.value=e,t._checkValidity(),t._updateCss(),a.update(),a.opts.autosubmit&&r())})}),e.addEventListener("blur",function(){t.show_error=!0,t._updateCss(),t.tag.parent.update()})}},{key:"focus",value:function(){}},{key:"keydown",value:function(){}},{key:"keyup",value:function(){}},{key:"change",value:function(){}},{key:"blur",value:function(){}}]),e}();Se.tag2class["ur-input"]=xe;var we=/*#__PURE__*/function(e){function t(){return n(this,t),g(this,p(t).apply(this,arguments))}return m(t,e),l(t,[{key:"createInput",value:function(){var e=this;this.css.input="form-select",this.input_tagname="select",this.input_type=void 0,b(p(t.prototype),"createInput",this).call(this),this.choices=ke(this),this.choices.forEach(function(t){L("option",{parent:e._input,innerHTML:t.label,id:t.id,value:t.value})}),this.ATTRS.forEach(function(t){e._input[t]=e[t]})}}]),t}(xe),Te=/*#__PURE__*/function(e){function t(e){var a;return n(this,t),e.tagName="ur-checkboxes",a=g(this,p(t).call(this,e)),a.choices=ke(_(a)),a.input_type="checkbox",a}return m(t,e),l(t,[{key:"createInput",value:function(){}},{key:"bindEvents",value:function(){var e=this;this.tag.on("mount",function(){e._getInputs().forEach(function(a){a.checked=e.value.includes(a.value),b(p(t.prototype),"bindEvents",e).call(e,a)})})}},{key:"_getInputs",value:function(){return v(this.tag.root.querySelectorAll("input"))}},{key:"_get_value",value:function(){return this._getInputs().filter(function(e){return e.checked}).map(function(e){return e.value})}}]),t}(xe),Ae=function(e){return"boolean"===e.type&&(e.choices=[["false","No"],["true","Yes"]]),Se.type2class[e.type]?Se.type2class[e.type]:Se.name2class[e.name]?Se.name2class[e.name]:e.choices?"list"===e.type?Te:we:xe},Oe={prepOpts:function(){this.opts.opts&&Object.assign(this.opts,this.opts.opts);var e=this.opts.matches;e&&he[e[1]]&&(this.opts.model=he[e[1]],this.opts.object=this.opts.model.objects.get(e[2]))},init:function(){var e=this;this.prepOpts(),this.inputs=[],A.defaults(this.opts,{success_text:"Submit",cancel_text:"Cancel",prefix:""}),A.assign(this,{title:this.opts.title,addInputs:function(){var a,r,s,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:e.opts,n=o.object,i=o.editable_fieldnames;if(n)o.initial=n.serialize(),a=n.getFields(),r=i||n.getFieldnames(),s=function(){Object.assign(n,e.getData());var a=Promise.resolve(n);return n.constructor.objects&&(a=n.constructor.objects.create(n.serialize())),a.then(function(a){e.success_message="".concat(a," has been saved"),o.success&&o.success(a),t.update()})};else if(o.model){var l=he.getModel(o.model);l.__makeMeta(),a=l.META.fields,r=i||l.editable_fieldnames,s=function(){return l.objects.create(e.getData()).then(function(a){e.success_message="".concat(a," has been created"),o.success&&o.success(a),t.update()})}}else if(o.schema)a=new Map(Object.entries(o.schema)),r=v(a.keys());else throw"ValueError: <ur-form> requires a schema, model, or object";var u=new Map;if(!r)throw"ur-form cannot be used without fieldnames";r.forEach(function(e){u.set(e,a.get(e))}),o.submit=o.submit||s,Array.from(u).filter(function(e){var t=f(e,2),a=t[0],s=t[1];return-1!==r.indexOf(a)}).map(Ee.prep)// #! TODO is this necessary for Object/Model or just raw schema
.forEach(e.addInput)},addInput:function(t){// converts a schema field to input options
var a={label:Ee.unslugify(t.name),id:"".concat(e.prefix||"","__").concat(t.name)};A.assign(a,t),"foreignkey"===a.type&&(a.choices=a.fk_model.objects.all().map(function(e){return[e.id,e.toString()]})),"list"===a.type&&(a.coerce=function(e){return e.split(",")}),e.opts.initial&&(a.initial=e.opts.initial[a.name]);var r=Ae(a);e.inputs.push(new r(a))},checkValidity:function(){return e.valid=!e.inputs.filter(function(e){return!e.valid}).length,e.valid},getData:function(){var e=c({},this.opts.initial);return this.inputs.forEach(function(t){return e[t.name]=t.value}),e}}),this.addInputs(this.opts)}},Pe=/*#__PURE__*/function(e){function t(){var e,a;n(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return a=g(this,(e=p(t)).call.apply(e,[this].concat(s))),u(_(a),"default_tag","ur-datetime"),a}return m(t,e),l(t,[{key:"_createInput",value:function(){var e,t,a=this;if(this.value){var r=new Date(this.value);e=s.format(r,"YYYY-MM-DD"),t=s.format(r,"HH:mm")}setTimeout(function(){return a._date_input.value=e},2e3),this._date_input=L("input",{type:"date",value:e,className:this.css.input,parent:this.tag.root}),this._time_input=L("input",{type:"time",value:t,className:this.css.input,parent:this.tag.root})}},{key:"_get_value",value:function(){var e=this._date_input.value+" "+this._time_input.value;return new Date(e).valueOf()}},{key:"bindTag",value:function(e){this.tag=e,e.input=this,this._createInput(),this.bindEvents(this._date_input),this.bindEvents(this._time_input),this._checkValidity()}}]),t}(xe);Se.type2class.datetime=Pe,t.tag2("ur-input","","","",function(){this.on("before-mount",()=>{this.opts.input.bindTag(this)})}),t.tag2("ur-form","<div class=\"{theme.outer}\"> <div class=\"{theme.header}\" if=\"{title}\"> <div class=\"{theme.header_title}\">{title}</div> </div> <div class=\"{theme.content}\"> <div class=\"rendered_content\"></div> <form onsubmit=\"{submit}\" class=\"{className}\"> <yield from=\"pre-form\"></yield> <div class=\"fields\"> <div each=\"{input,_i in inputs}\" class=\"{input.css.field}\"> <label if=\"{css.form.label}\" for=\"{input.id}\" class=\"{input.css.label}\"> {input.label} </label> <div data-is=\"{input.tagName}\" input=\"{input}\"></div> <div class=\"{input.css.error}\">{input.error}</div> <div class=\"{input.css.help_text}\">{input.help_text}</div> </div> </div> <div if=\"{error}\" class=\"{css.error}\" style=\"display: block;\">{error}</div> <div if=\"{success_message}\" class=\"{css.success}\" style=\"display: block;\"> {success_message}</div> <div class=\"button_div\"> <yield from=\"button_div\"></yield> <virtual if=\"{!opts.autosubmit}\"> <button class=\"{css.btn.success}\" onclick=\"{submit}\" disabled=\"{!valid}\"> {opts.success_text}</button> <button class=\"{css.btn.cancel}\" if=\"{opts.cancel}\" onclick=\"{cancel}\"> {opts.cancel_text}</button> </virtual> </div> </form> </div> </div>","","class=\"ur-form\"",function(){this.mixin(Oe),this.mixin(U),this.on("mount",()=>{this.update()}),this.on("update",()=>{this.checkValidity()}),this.submit=function(t){return this.error=void 0,t&&t.preventDefault&&t.preventDefault(),this.checkValidity()?void(this.update(),this.opts.submit(this).catch(t=>{throw this.error="An unknown error has occurred: "+t,this.update(),t})):(this.form.inputs.forEach(e=>e.show_error=!0),void this.update())}.bind(this),this.cancel=function(t){t&&t.preventDefault&&t.preventDefault(),this.opts.cancel.bind(this)(t)}.bind(this)}),t.tag2("ur-datetime","<div>Woot</div>","","",function(){this.on("before-mount",()=>{this.opts.input.bindTag(this)})}),t.tag2("ur-checkboxes","<div each=\"{choice in choices}\"> <input type=\"checkbox\" name=\"{input.name}\" id=\"{choice.id}\" riot-value=\"{choice.value}\"> <label for=\"{choice.id}\"> {choice.label} </label> </div>","ur-checkboxes,[data-is=\"ur-checkboxes\"]{ column-count: auto; column-width: 8rem; }","",function(){this.choices=[],this.on("before-mount",()=>{this.opts.input.bindTag(this),this.choices=this.input.choices}),this.on("update",()=>{})});var Ie=/*#__PURE__*/function(e){function t(e,a){var r;return n(this,t),r=g(this,p(t).call(this,e)),t._configs.push(_(r)),t._configs[e]=_(r),a&&r.setSchema(a),r}return m(t,e),l(t,[{key:"getDefault",value:function(e,t,a){a&&"string"!=typeof a||(a={type:a,_default:t}),a&&!this._schema[e]&&(this._schema[e]=a||{},this._schema[e].name=e),this.defaults[e]=t,this.has(e)||this.set(e,t)}},{key:"get",value:function(e){var a=b(p(t.prototype),"get",this).call(this,e);void 0===a&&(a=this.defaults[e]);var r=this._schema[e]&&this._schema[e].type;return"boolean"===r?"true"===a:"int"===r||"integer"===r?parseInt(a):"float"===r?parseFloat(a):a}},{key:"getSchema",value:function(e){var t=this;return this._getSchemaKeys(e).map(function(e){return t._schema[e]||e})}},{key:"setSchema",value:function(e){var t=this;// #! TODO: detect type and set to int/bool/char. Maybe if value is object extend object
if(!Array.isArray(e)){// assume it's name/value object
var r=e;for(var s in e=[],r)e.push({name:s,value:r[s]})}return a.each(e,function(e){"color"===e.type&&window.tinycolor&&(e.initial=window.tinycolor(e.initial).toHexString()),t.getDefault(e.name,e._default||e.value,e)}),this.getSchema()}},{key:"_getSchemaKeys",value:function(e){var t=[];for(var a in this._schema)e&&-1===e.indexOf(a)||this._schema.hasOwnProperty(a)&&t.push(a);return t}},{key:"getData",value:function(e){var t=this,r={};return a.each(this._getSchemaKeys(e),function(e){return r[e]=t.get(e)}),r}},{key:"openEditor",value:function(){var e,t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a.defaults(r,{schema:this.getSchema(),submit:function(a){t.update(a.getData()),e=!0},autosubmit:!0,onUnmount:function(){r&&r.cancel&&r.cancel(),e&&window.location.reload()}}),a.each(r.schema,function(e){e._default=e.value,e.value=t.get(e.name)}),r.ur_modal=!r.mount_to}}]),t}(me);Ie._configs=[];var Me=new me;Me.Storage=me,Me.Config=Ie,console.log(1);var Ce={ready:O(),Ready:O,Controller:ye,element:K,schema:Ee,form:{FormMixin:Oe,Input:xe,Select:we,DateTimeInput:Pe,config:Se},css:I,router:P,ajax:V,auth:D,storage:Me,db:he,admin:{DEBUG_URLS:[],URL_PREFIX:"admin",reverse:function(){var e=[this.URL_PREFIX].concat(Array.prototype.slice.call(arguments)).join("/");return"#!/".concat(e,"/")},start:function(){return D.ready(function(){if(D.user&&D.user.is_superuser){var e=function(e){return P.routeElement("ur-admin-"+e)};P.add({"#!/admin/$":e("home"),"#!/admin/([^/]+)/$":e("app"),"#!/admin/([^/]+)/([^/]+)/$":e("list"),"#!/admin/([^/]+)/([^/]+)/(\\d+|new)/$":e("edit")}),uR.element.create("a",{className:I.icon("edit"),href:"#!/admin/",parent:document.body,id:"admin-link"})}})}},Date:Date,TrueDate:Date};return void 0!==("undefined"==typeof window?"undefined":o(window))&&(window.onload=Ce.ready.start,window.__HMR_SKIP&&window.location.reload(),window.__HMR_SKIP=!0,Ce.ready.then(function(){if("undefined"!=typeof document){var t=v(document.querySelectorAll("script")).map(function(e){return e.src});Ce.SCRIPT_HASH=e(t)}Ce.db.ready.start(),Ce.db.ready.then(function(){Ce.auth.reset(),Ce.auth.ready(Ce.router.ready.start)})})),Ce});
